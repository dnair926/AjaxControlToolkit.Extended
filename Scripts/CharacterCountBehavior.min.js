Type.registerNamespace("WebExtenders");WebExtenders.CharacterCountBehavior=function(n){WebExtenders.CharacterCountBehavior.initializeBase(this,[n]);this._textbox=Sys.Extended.UI.TextBoxWrapper.get_Wrapper(n);this._dataFormatString="{5} total characters allowed. {1} characters entered.";this._treatCarriageReturnsAsOneCharacter=!1;this._maxWordLength=null;this._maxCharLength=null;this._warningPercentage=0;this._toolTipCssClass="character-count";this._toolTipCssClassForMax="character-count-max";this._toolTipCssClassForWarning="character-count-warning";this._popupMouseDown=!1;this._timer=null;this._enabled=!0;this._showDelay=2e3;this._container=null;this._popupDiv=null;this._popupPosition=WebExtenders.CharacterCountPosition.BottomLeft;this._popupBehavior=null;this._isOpen=!1;this._blur=new Sys.Extended.UI.DeferredOperation(1,this,this.blur);this._oncomplete$delegate=Function.createDelegate(this,this._element_onblur);this._element$delegates={keyup:Function.createDelegate(this,this._element_onevent),focus:Function.createDelegate(this,this._element_onevent),blur:Function.createDelegate(this,this._element_onblur)}};WebExtenders.CharacterCountBehavior.prototype={get_showDelay:function(){return this._showDelay},set_showDelay:function(n){this._showDelay!==n&&(this._showDelay=n,this.raisePropertyChanged("showDelay"))},get_dataFormatString:function(){return this._dataFormatString},set_dataFormatString:function(n){this._dataFormatString!==n&&(this._dataFormatString=n,this.raisePropertyChanged("dataFormatString"))},get_treatCarriageReturnsAsOneCharacter:function(){return this._treatCarriageReturnsAsOneCharacter},set_treatCarriageReturnsAsOneCharacter:function(n){this._treatCarriageReturnsAsOneCharacter!==n&&(this._treatCarriageReturnsAsOneCharacter=n,this.raisePropertyChanged("treatCarriageReturnsAsOneCharacter"))},get_maxWordLength:function(){return this._maxWordLength},set_maxWordLength:function(n){this._maxWordLength!==n&&(this._maxWordLength=n,this.raisePropertyChanged("maxWordLength"))},get_maxCharLength:function(){return this._maxCharLength},set_maxCharLength:function(n){this._maxCharLength!==n&&(this._maxCharLength=n,this.raisePropertyChanged("maxCharLength"))},get_warningPercentage:function(){return this._warningPercentage},set_warningPercentage:function(n){this._warningPercentage!==n&&(this._warningPercentage=n,this.raisePropertyChanged("warningPercentage"))},get_toolTipCssClass:function(){return this._toolTipCssClass},set_toolTipCssClass:function(n){this._toolTipCssClass!==n&&(this._toolTipCssClass=n,this.raisePropertyChanged("toolTipCssClass"))},get_toolTipCssClassForMax:function(){return this._toolTipCssClassForMax},set_toolTipCssClassForMax:function(n){this._toolTipCssClassForMax!==n&&(this._toolTipCssClassForMax=n,this.raisePropertyChanged("toolTipCssClassForMax"))},get_toolTipCssClassForWarning:function(){return this._toolTipCssClassForWarning},set_toolTipCssClassForWarning:function(n){this._toolTipCssClassForWarning!==n&&(this._toolTipCssClassForWarning=n,this.raisePropertyChanged("toolTipCssClassForWarning"))},get_enabled:function(){return this._enabled},set_enabled:function(n){this._enabled!==n&&(this._enabled=n,this.raisePropertyChanged("enabled"))},get_popupPosition:function(){return this._popupPosition},set_popupPosition:function(n){this._popupPosition!==n&&(this._popupPosition=n,this.raisePropertyChanged("popupPosition"))},get_isOpen:function(){return this._isOpen},initialize:function(){WebExtenders.CharacterCountBehavior.callBaseMethod(this,"initialize");var n=this.get_element();n.readOnly||$addHandlers(n,this._element$delegates)},dispose:function(){this._popupBehavior&&(this._popupBehavior.dispose(),this._popupBehavior=null);this._container&&(this._container.parentNode&&this._container.parentNode.removeChild(this._container),this._container=null);var n=this.get_element();$common.removeHandlers(n,this._element$delegates);WebExtenders.CharacterCountBehavior.callBaseMethod(this,"dispose")},show:function(){this._ensurePopup();this._countChar()},hide:function(){this._isOpen&&(this._container&&this._popupBehavior.hide(),this._isOpen=!1)},focus:function(){this.get_element().focus()},blur:function(n){n||Sys.Browser.agent!==Sys.Browser.Opera?this.hide():this._blur.post(!0)},suspendLayout:function(){this._layoutSuspended++},resumeLayout:function(){this._layoutSuspended--;this._layoutSuspended<=0&&(this._layoutSuspended=0,this._layoutRequested&&this._performLayout())},invalidate:function(){this._layoutSuspended>0?this._layoutRequested=!0:this._performLayout()},_ensurePopup:function(){if(!this._container){var n=this.get_element(),t=this.get_id();this._container=$common.createElementFromTemplate({nodeName:"div",properties:{id:t+"_container"}},n.parentNode);this._popupDiv=$common.createElementFromTemplate({nodeName:"div",properties:{id:t+"_popupDiv"},visible:!1},this._container);this._popupBehavior=new $create(Sys.Extended.UI.PopupBehavior,{parentElement:n},{},{},this._popupDiv);this._popupPosition===WebExtenders.CharacterCountPosition.TopLeft?this._popupBehavior.set_positioningMode(Sys.Extended.UI.PositioningMode.TopLeft):this._popupPosition===WebExtenders.CharacterCountPosition.TopRight?this._popupBehavior.set_positioningMode(Sys.Extended.UI.PositioningMode.TopRight):this._popupPosition===WebExtenders.CharacterCountPosition.BottomRight?this._popupBehavior.set_positioningMode(Sys.Extended.UI.PositioningMode.BottomRight):this._popupPosition===WebExtenders.CharacterCountPosition.Right?this._popupBehavior.set_positioningMode(Sys.Extended.UI.PositioningMode.Right):this._popupPosition===WebExtenders.CharacterCountPosition.Left?this._popupBehavior.set_positioningMode(Sys.Extended.UI.PositioningMode.Left):this._popupBehavior.set_positioningMode(Sys.Extended.UI.PositioningMode.BottomLeft)}},_element_onfocus:function(){this._enabled&&this.show()},_element_onblur:function(){this._enabled&&this.blur()},_element_onevent:function(){this._enabled&&this.show()},_countChar:function(){var i,o,s,h,c;this._timer&&(clearTimeout(this._timer),this._timer=null);var r=this._textbox.get_Value(),t=0,u=0,n=0,f=0,l=r.replace(/\s/g," "),e=l.split(" ");for(i=0;i<e.length;i++)e[i].length>0&&t++;this._treatCarriageReturnsAsOneCharacter?(o=r.replace("\r\n","\n"),n=o.length):n=r.length;this._maxCharLength>0&&this._maxCharLength-n>0&&(f=this._maxCharLength-n);this._maxWordLength>0&&this._maxWordLength-t>0&&(u=this._maxWordLength-t);s=this._popupDiv.innerHTML.length;this._popupDiv.innerHTML=this._dataFormatString.replace("{0}",t).replace("{1}",n).replace("{2}",u).replace("{3}",f).replace("{4}",this._maxWordLength).replace("{5}",this._maxCharLength);h=this._popupDiv.innerHTML.length;c=this._popupDiv.className;this._popupDiv.className=this._toolTipCssClass;(this._toolTipCssClass!==""||this._toolTipCssClassForWarning!==""||this._toolTipCssClassForMax!=="")&&(this._maxCharLength>0||this._maxWordLength>0)&&this._warningPercentage>0&&((n>this._maxCharLength&&this._maxCharLength>0||t>this._maxWordLength&&this._maxWordLength>0)&&this._toolTipCssClassForMax!==""?(this._popupDiv.className=this._popupDiv.className.replace(this._toolTipCssClass,""),this._popupDiv.className=this._popupDiv.className.replace(this._toolTipCssClassForWarning,""),this._popupDiv.className.search(this._toolTipCssClassForMax)===-1&&(this._popupDiv.className=this._popupDiv.className+" "+this._toolTipCssClassForMax)):(n>=this._warningPercentage/100*this._maxCharLength&&this._maxCharLength>0||t>=this._warningPercentage/100*this._maxWordLength&&this._maxWordLength>0)&&this._toolTipCssClassForWarning!==""?(this._popupDiv.className=this._popupDiv.className.replace(this._toolTipCssClass,""),this._popupDiv.className=this._popupDiv.className.replace(this._toolTipCssClassForMax,""),this._popupDiv.className.search(this._toolTipCssClassForWarning)===-1&&(this._popupDiv.className=this._popupDiv.className+" "+this._toolTipCssClassForWarning)):(this._popupDiv.className=this._popupDiv.className.replace(this._toolTipCssClassForWarning,""),this._popupDiv.className=this._popupDiv.className.replace(this._toolTipCssClassForMax,""),this._popupDiv.className.search(this._toolTipCssClass)===-1&&(this._popupDiv.className=this._popupDiv.className+" "+this._toolTipCssClass)));this._timer=setTimeout(this._oncomplete$delegate,this.get_showDelay());this._isOpen?(this._popupDiv.className!==c||s!==h)&&(this._popupBehavior.hide(),this._popupBehavior.show()):(this._isOpen=!0,this._popupBehavior.show())}};WebExtenders.CharacterCountBehavior.registerClass("WebExtenders.CharacterCountBehavior",Sys.Extended.UI.BehaviorBase);WebExtenders.CharacterCountPosition=function(){throw Error.invalidOperation();};WebExtenders.CharacterCountPosition.prototype={BottomLeft:0,BottomRight:1,TopLeft:2,TopRight:3,Right:4,Left:5};WebExtenders.CharacterCountPosition.registerEnum("WebExtenders.CharacterCountPosition");